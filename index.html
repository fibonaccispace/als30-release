
<style>
@font-face {
    font-family: als_enormous_sb;
    src: url(media/fonts/ALSEnormous-SemiBold.woff2);
}

@font-face {
    font-family: als_enormous_r;
    src: url(media/fonts/ALSEnormous-Regular.woff2);
}

@font-face {
    font-family: als_enormous_m;
    src: url(media/fonts/ALSEnormous-Medium.woff2);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    color: white;
}
</style>

<style>
#gallery {
    perspective: 100px;
    overflow: hidden;
}
#gallery .history-block:active {
    transform: scale(.97);
    filter: saturate(120%) brightness(1.2);
}
#gallery .history-block {
    transition: .2s ease-out;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 80px;
    cursor: pointer;
    /* margin-bottom: 196px; */
}
#gallery .date-wrapper {
    position: relative;
    margin-bottom: 16px;
}
#gallery .date-wrapper img {
    width: 70px;
}
#gallery .date-wrapper span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-50%);
    font-family: als_enormous_m;

    font-size: 18px;
    text-align: center;
}
#gallery .history-block__image {
    user-select: none;
    max-width: 70%;
}
#gallery .uniq-width {
    max-width: none;
    z-index: -1;
}
#gallery .history-block__title {
    font-family: als_enormous_m;
    font-size: 28px;
    text-align: center;
    margin-bottom: 60px;
    max-width: 600px;
}
body {
    background: rgb(0, 0, 0);
    height: 1000vh;
}
#background_video {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    z-index: -1;
    opacity: 0;
    transition: .2s ease;
    filter: hue-rotate(130deg);
}
.paralax {
    margin-top: 10%;
    position: fixed;
    transform: rotateX(-12deg);
    left: 0;
    top: 0;
    width: 100%;
    height: 120%;
    z-index: -1;
}
.paralax-item {
    position: absolute;
    width: 4px;
    height: 4px;
    top: 0;
    left: 0;
    transform: translate(-50%,-50%);
    transition: height .3s ease-out, width .3s ease-out;
    opacity: 1;
    pointer-events: none;
}

.quote {
    max-width: 800px;
    margin: 200px auto 80px auto;
    position: relative;
    z-index: 10;
}
.quote img {
    display: block;
    margin: 0 auto 26px auto;
    width: 160px;
}
.quote-text {
    font-family: als_enormous_m;
    font-size: 48px;
    text-align: center;
    margin-bottom: 26px;
}
.quote:has(.giant) {
    max-width: 90%;
}
.quote .giant {
    font-size: 128px;
    line-height: 110%;
}
.quote-author {
    font-family: als_enormous_r;
    font-size: 21px;
    text-align: center;
}
.bg-video {
    width: 100%;
    height: 100vh;
    position: fixed;
    z-index: -100;
}
#background_video2 {
    position: fixed;
    bottom: -100%;
    left: 0;
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    z-index: -1;
    opacity: 0;
    transition: 2s ease;
    transform: scale(-1);
    filter: hue-rotate(130deg);
}
</style>

<div class="bg-video">
<!-- <video autoplay muted loop playsinline id="background_video">
    <source src="media/background.mp4" type="video/mp4">
</video> -->
</div>

<style>
.main__logo-video {
    width: 100%;
    opacity: 0;
    transition: 1.2s ease;
}
p.main__logo-description {
    font-family: als_enormous_r;
}
.main__logo-be-history {
    font-family: als_enormous_m;
    font-size: 21px;
    text-align: center;
}
.main__logo-be-history {
    color: white;
    cursor: pointer;
    transition: 1s ease;
}
.main__logo {
    margin-bottom: 10vh;
    position: relative;
}

p.main__logo-description {
    max-width: 780px;
    font-weight: 50;
    font-size: 28px;
    text-align: center;
    z-index: 10;
    position: relative;
    margin: -10% auto 50px auto;
}

.main__logo .main__logo-image {
    width: 100%;
    display: block;
}

.main__logo .main__particles-list {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 80%;
}

.main__logo .main__particles-item {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    -webkit-transform: translate(-50%, -50%);
}
.history-block-rotate {
    transition: .1s;
}
.history-block__video {
    border-radius: 20px;
}
.perspective-block {
    position: fixed;
    z-index: -1;
    top: 0;
    perspective: 200px;
    width: 100vw;
    height: 100vh;
}
#finish {
    position: relative;
    width: 100%;
    height: 100vh;

    display: flex;
    justify-content: center;
    flex-direction: column;
    align-items: center;
}

.be-history-bg:before {
    content: '';
    display: block;
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(red, white);
    top: 0;
    left: 0;
    transition: 1s;
}
.be-history-bg {
    margin: 50px auto 0 auto;
    width: fit-content;
    overflow: hidden;
    position: relative;
    border-radius: 300px;
    background: white;
    padding: 5px;
    cursor: pointer;
    transition: all 1s, transform .8s;
    box-shadow: 0 20px 200px 40px rgba(255,0,0,.8);
}
.be-history-content {
    width: fit-content;
    overflow: hidden;
    position: relative;
    border-radius: 300px;
    background: red;
    padding: 15px 70px 25px 70px;
    cursor: pointer;
    
    font-size: 36px;
    font-family: als_enormous_m;
    box-shadow: inset 0 10px 15px rgba(255, 0, 0, 1)
}
.be-history-content:before {
    content: '';
    display: block;
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(rgb(255, 158, 158), red);
    transition: 1s;
}
.be-history-content span {
    position: relative;
    z-index: 10;
    user-select: none;
}



.be-history-bg:hover:before {
    transform: translate(0, -100%);
}
.be-history-content:hover:before {
    transform: translate(0, -100%);
}
.be-history-bg:active {
    transform: scale(1) !important;
    transition: transform .2s;
}
.be-history-bg:hover {
    box-shadow: 0 20px 200px 40px rgba(255,0,0,1);
    transform: scale(1.05) translateY(-5px);
}
.be-history-fized {
    user-select: none;
    cursor: pointer;
    position: fixed;
    right: 30px;
    bottom: 30px;
    z-index: 1000;
    background: blue;
    padding: 10px 20px;
    border-radius: 100px;
    font-family: als_enormous_m;
}

.finish-particles {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.mini-particle{
    position: absolute;
    width: 200px;
    top: 50%;
    left: 50%;
}



</style>
<div class="be-history-fized">Стать частью истории</div>
<article class="main__logo">
    <video autoplay muted loop playsinline class="main__logo-video">
        <source src="media/txt-alpha-v1.webm" type="video/webm">
    </video>
    <div class="main__particles-list" id="particles-list"></div>
    <p class="main__logo-description">Когда мы&nbsp;начинали, интернет только учился ходить. За&nbsp;тридцать лет, наш дизайн стал голосом брендов, лицом событий, частью культурного контекста. Тридцать лет назад мы&nbsp;начали с&nbsp;идей, которые опережали свое время.</p>
    <div class="be-history-bg">
        <div class="be-history-content">
            <span>Стать частью истории</span>
        </div>
    </div>
</article>
<div id="gallery"></div>
<div id="finish">
    <div class="finish-particles"></div>
    <img src="media/als30.svg" style="z-index: 100;">
    <div class="be-history-bg">
        <div class="be-history-content">
            <span>Стать частью истории</span>
        </div>
    </div>
</div>
<div class="perspective-block">
    <div class="paralax" id="paralax"></div>
</div>

<script>
//const video = document.getElementById('background_video')
//video.addEventListener('canplaythrough', () => {
//    video.style.opacity = 1
//})

const video = document.querySelector('.main__logo-video')
video.addEventListener('canplaythrough', () => {
    setTimeout(()=>{
       video.style.opacity = 1
    },200)
})
</script>

<script>
const gallery = document.getElementById('gallery')
let lastScroll = window.scrollY
let frame = true
let spawnBorder = 50
const finish = document.getElementById('finish')
const quotes = []

const random = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min
const uniform = (min, max) => (Math.random() * (max - min + 1)) + min
const minmax = (min, value, max) => Math.min(Math.max(min, value), max)

const images = [
    'item1.png', 'item2.png', 'item3.png', 'item4.png', 
    'item5.png', 'item6.png', 'item7.png', 'item8.png', 
    'item9.png', 'item10.png', 'item11.png', 'item12.png', 
    'item13.png', 'item14.png', 'item15.png', 'item16.png', 
    'item17.png', 'item18.png', 'item19.png', 'item20.png', 
]

const positions = [
    { x: 80, y: 30, z: 1 }, { x: 50, y: 42, z: 1 }, { x: 72, y: 45, z: 1 }, { x: 12, y: 71, z: 1 },
    { x: 32, y: 91, z: 1 }, { x: 47, y: 95, z: 1 }, { x: 61, y: 89, z: 1 }, { x: 56, y: 17, z: 1 },
    { x: 28, y: 32, z: -1 }, { x: 69, y: 29, z: 1 }, { x: 40, y: 18, z: 1 }, { x: 55, y: 55, z: 1 },
    { x: 12, y: 32, z: 1 }, { x: 51, y: 83, z: 1 }, { x: 73, y: 85, z: 1 }, { x: 30, y: 66, z: 1 }, 
    { x: 69, y: 96, z: 1 }, { x: 87, y: 83, z: 1 }, { x: 19, y: 84, z: 1 }, { x: 30, y: 13, z: 1 },
]

const wrapper = document.getElementById('particles-list')
const finishWrapper = document.querySelector('.finish-particles')

fillBlockFixedParticles(wrapper)
// fillBlockFixedParticles(finishWrapper)

function fillBlockFixedParticles(where) {
    const offset = random(0, images.length)
    for(let i = 0; i < images.length; i++){
        const path = images[i]
        const index = (i+offset)%positions.length
        const rotate = uniform(-30, 30)
        const scale = uniform(0.5, 1)

        const item = document.createElement('img')
        item.src = 'media/particles/'+path
        item.classList.add('main__particles-item')
        item.style.position = 'absolute'
        item.style.top = positions[index].y + '%'
        item.style.left = positions[index].x + '%'
        item.style.zIndex = positions[index].z
        item.style.transform = 'translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ')'
        item.style.webkitTransform = item.style.transform
        item.style.opacity = 0
        item.style.width = '0px'
        item.style.height = '0px'
        item.style.transition = 'all .5s ease'
        item.style.webkitTransition = 'all .5s ease'

        setTimeout(() => {
            item.style.opacity = 1
            item.style.width = '16px'
            item.style.height = '16px'
        }, random(100, 500))

        const style = document.createElement('style')
        const keyframes =
        '@keyframes floatItem' + index + ' {' +
            '0% { transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-40, 41) + 'px,' + random(-40, 41) + 'px) rotate(' + uniform(-20, 20) + 'deg) }' +
            '25% { transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-40, 41) + 'px,' + random(-40, 41) + 'px) rotate(' + uniform(-20, 20) + 'deg) }' +
            '50% { transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-40, 41) + 'px,' + random(-40, 41) + 'px) rotate(' + uniform(-20, 20) + 'deg) }' +
            '75% { transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-40, 41) + 'px,' + random(-40, 41) + 'px) rotate(' + uniform(-20, 20) + 'deg) }' +
            '100% { transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-40, 41) + 'px,' + random(-40, 41) + 'px) rotate(' + uniform(-20, 20) + 'deg) }' +
        '}' +
        '@-webkit-keyframes floatItem' + index + ' {' +
            '0% { -webkit-transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-20, 21) + 'px,' + random(-20, 21) + 'px) rotate(' + uniform(-10, 10) + 'deg) }' +
            '25% { -webkit-transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-20, 21) + 'px,' + random(-20, 21) + 'px) rotate(' + uniform(-10, 10) + 'deg) }' +
            '50% { -webkit-transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-20, 21) + 'px,' + random(-20, 21) + 'px) rotate(' + uniform(-10, 10) + 'deg) }' +
            '75% { -webkit-transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-20, 21) + 'px,' + random(-20, 21) + 'px) rotate(' + uniform(-10, 10) + 'deg) }' +
            '100% { -webkit-transform: translate(-50%,-50%) rotate(' + rotate + 'deg) scale(' + scale + ') translate(' + random(-20, 21) + 'px,' + random(-20, 21) + 'px) rotate(' + uniform(-10, 10) + 'deg) }' +
        '}'

        style.textContent = keyframes
        document.head.appendChild(style)

        item.style.animation = 'floatItem' + index + ' ' + random(10, 30) + 's infinite alternate'
        item.style.webkitAnimation = item.style.animation

        where.append(item)
    }
}

const items = [
    { link: 'https://www.artlebedev.ru/yandex/identity3/', image: 'ya.png', year: 1999, title: 'Логотип &laquo;Яндекса&raquo;' },
    { link: 'https://www.artlebedev.ru/rostselmash/', image: 'rostselmash.png', year: 2004, title: 'Логотип &laquo;Ростсельмаша&raquo;' },
    { link: 'https://www.artlebedev.ru/bbk/remotes/', image: 'bbk.png', year: 2006, title: 'Пульт BBK', width: '500px' },
    { link: 'https://www.artlebedev.ru/nashe_kino/gruz200/', image: 'gruz200.png', year: 2007, title: 'Плакат кинофильма<br>&laquo;Груз 200&raquo;' },
    { quote: true, text: 'Нет готовых рецептов дизайнерского успеха, потому что их&nbsp;вообще никто&nbsp;не&nbsp;знает.', author: 'Артемий Лебедев<br>худрук' },
    { link: 'https://www.artlebedev.ru/lights-and-belts/', image: 'board1.png', year: 2008, title: 'Дорожный знак<br>&laquo;Фары и&nbsp;ремень&raquo;' },
    { link: 'https://www.artlebedev.ru/perm/logo/', image: 'perm.png', year: 2009, title: 'Логотип Перми' },
    { link: 'https://www.artlebedev.ru/bolshoi/', image: 'bigt.png', year: 2011, title: 'Большой театр', width: '180%' },
    { link: 'https://www.artlebedev.ru/photo-ok/', image: 'smile.png', year: 2011, title: 'Знак &laquo;Фотографировать<br>разрешено&raquo;' },
    { link: 'kkkkkkkk', quote: true, text: 'Идея ничего не&nbsp;стоит.', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://www.artlebedev.ru/gorky-park/', image: 'park2.png', year: 2012, title: 'Парк Горького', top: '-15%' },
    { link: 'https://www.artlebedev.ru/odessa/identity/', image: 'odessa.png', year: 2012, title: 'Логотип Одессы' },
    { link: 'https://www.artlebedev.ru/kovodstvo/sections/159/', image: 'rubl.png', year: 2013, title: 'Знак рубля', width: '700px' },
    { link: 'https://www.artlebedev.ru/age/vector/', image: '18+.png', year: 2013, title: 'Знаки возрастных<br>ограничений' },
    { link: 'https://www.artlebedev.ru/pulkovo/', image: 'pulk.png', year: 2014, title: 'Аэропорт &laquo;Пулково&raquo;' },
    { quote: true, text: 'Не&nbsp;уживайся с&nbsp;однообразием!', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://www.artlebedev.ru/metro/', image: 'metro.png', year: 2014, title: 'Московское метро' },
    { link: 'https://www.artlebedev.ru/moscow/street-signs/', image: 'board3.png', year: 2014, title: 'Уличные указатели в&nbsp;Москве' },
    { link: 'https://www.artlebedev.ru/yakitoriya/identity/', image: 'yk.png', year: 2014, title: 'Логотип &laquo;Якитории&raquo;' },
    { link: 'https://www.artlebedev.ru/scout/', image: 'helic.png', year: 2015, title: 'Вертолет &laquo;Скаут&raquo;', width: '180%', top: '-20%' },
    { link: 'https://www.artlebedev.ru/deptrans/parking4/', image: 'parking.png', year: 2015, title: 'Московские парковки', width: '40%'},
    { quote: true, text: 'Звезда&nbsp;&mdash; наше всё.', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://www.artlebedev.ru/russianpost/mailbox/', image: 'mail.png', year: 2015, title: 'Почтовые ящики<br>Почты России' },
    { link: 'https://www.artlebedev.ru/moscow/um/', image: 'mos.png', year: 2015, title: 'Промо-сайт<br>&laquo;Узнай Москву&raquo;', top: '-15%' },
    { link: 'https://www.artlebedev.ru/luzhniki/facade/', image: 'luzh.png', year: 2016, title: 'Фасады и&nbsp;навигация<br>Лужников' },
    { link: 'https://www.artlebedev.ru/metro/rumyantsevo/', image: 'rumancevo.png', year: 2016, title: 'Шрифтовое оформление станции метро &laquo;Румянцево&raquo;' },
    { link: 'https://www.artlebedev.ru/autonomous-car-sign/', image: 'aicar.png', year: 2016, title: 'Дорожный знак &laquo;Движение беспилотных транспортных средств&raquo;' },
    { quote: true, text: 'Умение оценивать хороший дизайн является не&nbsp;меньшим достижением, чем умение его создавать.', author: 'Артемий Лебедев.<br>&laquo;Ководство&raquo;' },
    { link: 'https://www.artlebedev.ru/cska/', image: 'cska.png', year: 2016, title: 'Проекты ХК&nbsp;ЦСКА' },
    { link: 'https://www.artlebedev.ru/zaryadye/', image: 'zar.png', year: 2017, title: 'Навигация парка Зарядье' },
    { link: 'https://www.artlebedev.ru/mosgortrans/pattern/', image: 'pattern.png', year: 2017, title: 'Паттерн для сидений московского наземного транспорта', width: '100%' },
    { link: 'https://tema.livejournal.com/2459464.html', image: 'nike.png', year: 2017, title: 'Кроссовок<br>Найк' },
    { link: 'https://www.artlebedev.ru/sozvezdie/portable-transmitter/', image: 'racia.png', year: 2018, title: 'Радиостанции<br>Созвездие', top: '-40%', width: '80%'},
    { quote: true, text: 'Завязывай<br>со стилизацией!', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://www.artlebedev.ru/svo/', image: 'clock.png', year: 2018, title: 'Навигация Шереметьево' },
    { link: 'https://www.artlebedev.ru/vdnh/scheme/', image: 'vdnh.png', year: 2018, title: 'Навигация ВДНХ' },
    { link: 'https://www.artlebedev.ru/deptrans/electrobus/', image: 'electrobus.png', year: 2018, title: 'Это электробус', width: '95%' },
    { link: 'https://www.artlebedev.ru/mosgortrans/visual-communication/', image: 'comm.png', year: 2018, title: 'Визуальная коммуникация для наземного транспорта Москвы' },
    { link: 'https://www.artlebedev.ru/active-citizen/identity/', image: 'ag.png', year: 2018, title: 'Айдентика проекта &laquo;Активный гражданин&raquo;' },
    { quote: true, text: 'Лучшие идеи приходят к&nbsp;тем,&nbsp;для кого решаемая проблема&nbsp;&mdash; личная.', author: 'Сергей Кулинкович<br>арт-директор' },
    { link: 'https://www.artlebedev.ru/rpl/logo/', image: 'ball.png', year: 2018, title: 'Проекты РПЛ' },
    { link: 'https://www.artlebedev.ru/fc-krasnodar/navigation/', image: 'krasnodar.png', year: 2019, title: 'Навигация стадиона и&nbsp;парка Краснодар' },
    { link: 'https://www.artlebedev.ru/federationtower/logo/', image: 'federatsia.png', year: 2019, title: 'Айдентика Башни Федерация' },
    { link: 'https://www.artlebedev.ru/moscow-zoo/', image: 'zoo.png', year: 2019, title: 'Московский зоопарк' },
    { link: 'https://www.artlebedev.ru/rzd/ticket/', image: 'rzd.png', year: 2019, title: 'Электронный билет РЖД' },
    { quote: true, text: 'Делай в&nbsp;лоб!', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;', size: true },
    { link: 'https://www.artlebedev.ru/moya-poliklinika/', image: 'mp.png', year: 2019, title: 'Моя поликлиника' },
    { link: 'https://www.artlebedev.ru/asics/', image: 'aml.png', year: 2019, title: 'Асикс и&nbsp;Метро', top: '-7%' },
    { link: 'https://www.artlebedev.ru/roc/mascots/', image: 'mascots.png', year: 2019, title: 'Талисманы &laquo;Команды России&raquo;' },
    { link: 'https://www.artlebedev.ru/leningrad/logo/', video: 'leningrad.mp4', year: 2019, title: 'Ленинград' },
    { link: 'https://www.artlebedev.ru/tretyakovgallery/lavrus-identity/', video: 'lavrus.mp4', year: 2019, title: 'Лаврус' },
    { quote: true, text: 'Сделать хорошо возможно с&nbsp;любым набором ограничений.', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://www.artlebedev.ru/radius/', image: 'watch.png', year: 2020, title: 'Часы &laquo;Радиус&raquo;', width: '700px' },
    { link: 'https://www.artlebedev.ru/yakutsk/design-code/', image: 'ykutsk.png', year: 2020, title: 'Дизайн-код Якутска' },
    { link: 'https://www.artlebedev.ru/ironov/1/', video: 'ironov.mp4', year: 2020, title: 'Николай Иронов' },
    { link: 'https://www.artlebedev.ru/made-in-russia/mark/vector/', image: 'ru.png', year: 2020, title: 'Знак &laquo;Сделано в&nbsp;России&raquo;' },
    { link: 'https://www.artlebedev.ru/aquarium/site2/', image: 'aqua.png', year: 2020, title: 'Сайт &laquo;Аквариума&raquo; 2.0', width: '125%', top: '-30%' },
    { quote: true, text: 'Не&nbsp;надо стесняться пробовать и&nbsp;делать&nbsp;то, что другим кажется ерундой.', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://www.artlebedev.ru/deptrans/mostransport/', image: 'comm2.png', year: 2021, title: 'Новый язык коммуникаций Московского транспорта' },
    { link: 'https://www.artlebedev.ru/metro/nameplates/', image: 'metrovagonmash.png', year: 2021, title: 'Таблички и&nbsp;наклейки для поездов Метровагонмаша' },
    { link: 'https://www.artlebedev.ru/vnukovo/navigation/', image: 'vnukovo.png', year: 2022, title: 'Навигация<br>для аэропорта Внуково', top: '-8%' },
    { link: 'https://www.artlebedev.ru/noyabrsk/bus-stop/', image: 'noyabrsk.png', year: 2022, title: 'Остановки общественного транспорта Ноябрьска' },
    { link: 'https://www.artlebedev.ru/narayone/', image: 'narayone.gif', year: 2022, title: 'На районе' },
    { quote: true, text: 'Люби недолюбленное!', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://moskvichmag.ru/gorod/skandalnyj-znak-vysadil-i-uehal-u-litseya-kapitsy-zamenili-znakom-chmoki-i-poki/', image: 'poka.png', year: 2022, title: 'Дорожный знак &laquo;Чмоки и&nbsp;поки&raquo;' },
    { link: 'https://www.artlebedev.ru/teriberka/stele/', image: 'teriberka.png', year: 2022, title: 'Стела для Териберки' },
    // Сайт истории российского флага  https://www.artlebedev.ru/flag/site/
    { link: 'https://www.artlebedev.ru/constitution-of-russia/site2/', video: 'constitution.mp4', year: 2023, title: 'Вторая версия сайта<br>Конституции России', width: '70%', part: { image: 'c-part.svg', z: -1, pos: {x: 250, y: -130} } },  
    { link: 'https://www.artlebedev.ru/dobrodel/logo/', image: 'dobro.png', year: 2023, title: 'Логотип проекта<br>&laquo;Добродел&raquo;' },
    { quote: true, text: 'Дизайн&nbsp;&mdash; это стратегия.', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    { link: 'https://www.artlebedev.ru/ufa/navigation/', image: 'ufa.png', year: 2023, title: 'Туристическая навигация<br>для Уфы' },
    { link: 'https://www.artlebedev.ru/5ka/store/', image: '5.png', year: 2023, title: 'Интерьеры магазинов<br>&laquo;Пятёрочка&raquo;' },
    { link: 'https://www.artlebedev.ru/akkuyu/', image: 'akkuyu.png', year: 2023, title: 'Сайт атомной электростанции<br>&laquo;Аккую&raquo;', top: '-30%', width: '100%' },
    { link: 'https://www.artlebedev.ru/m-11/podmoskovye/', image: 'm11.png', year: 2024, title: 'Название и&nbsp;логотип<br>&laquo;М11&nbsp;Подмосковье&raquo;', top: '-12%' },
    { link: 'https://www.artlebedev.ru/minjust/', image: 'minjust.png', year: 2024, title: 'Айдентика<br>Министерства юстиции<br>Российской Федерации' },
    { quote: true, text: 'Дизайн&nbsp;&mdash; это война.', author: 'Из&nbsp;книги &laquo;Принципы и&nbsp;парадоксы.<br>25&nbsp;лет Студии Артемия Лебедева&raquo;' },
    // Сайт Министерства энергетики Российской Федерации  https://www.artlebedev.ru/minenergo/
    { link: 'https://www.artlebedev.ru/murmansk/', image: 'mur.png', year: 2024, title: 'Мурманск' },
]

items.forEach((item)=>{
    createHistoryBlock(item)
})

function createHistoryBlock(item) {
    if(!gallery) return

    if(item.quote) {
        const quote = document.createElement('div')
        quote.classList.add('quote')

        quote.innerHTML = 
        '<img src="media/quote.svg">'+
        (item.size ? '<h1 class="quote-text giant">'+item.text+'</h1>' : '<h1 class="quote-text">'+item.text+'</h1>') +
        '<p class="quote-author">'+item.author+'</p>'

        gallery.append(quote)
        quotes.push(quote)
        return
    }

    const year =
    '<div class="date-wrapper">'+
        '<img src="media/date_bg.svg">'+
        '<span>'+item.year+'</span>'+
    '</div>'
    
    const title = 
    '<h2 class="history-block__title">'+item.title+'</h2>'

    let content = ''
    if(item.image){
        content = '<img style="margin-top: '+item.top+'" width="'+item.width+'" class="history-block__image '+(item.width?'uniq-width':'')+' " src="media/blocks/'+item.image+'" alt="'+item.title+'">'
    } else if(item.video){
        content = '<video autoplay muted loop playsinline style="margin-top: '+item.top+'" width="'+item.width+'" class="history-block__image history-block__video" src="media/blocks/'+item.video+'" alt="'+item.title+'">'
    }

    const block = document.createElement('div')
    block.classList.add('history-block')
    block.innerHTML = year + title + content

    const rotateBlock = document.createElement('div')
    rotateBlock.classList.add('history-block-rotate')
    rotateBlock.append(block)

    if(item.part) {
        const part = document.createElement('img')
        part.src = 'media/blocks/'+item.part.image
        part.style.zIndex = item.part.z
        part.classList.add('mini-particle')
        part.style.transform = 'translate(-50%,-50%) translate('+item.part.pos.x+'% ,'+item.part.pos.y+'%)'
        rotateBlock.append(part)
    }

    item.element = rotateBlock
    gallery.append(rotateBlock)

    if(item.link){
        item.element.addEventListener('click', ()=>{
            window.open(item.link);
        })
    }
}

function createParalaxItem(pos, velocity) {
    const item = document.createElement('div')
    const img = document.createElement('img')
    const path = 'media/particles/item'+random(0,50)+'.png'
    img.src = path
    img.style.width = '100%'
    img.style.height = '100%'
    item.append(img)

    item.classList.add('paralax-item')
    item.style.top = pos+'%'
    item.pos = pos
    item.velocity = (velocity?velocity:0)
    item.speed = uniform(1,2)
    item.style.left = Math.random()*100+'%'
    paralax.append(item)
}

const paralax = document.getElementById('paralax')
for(let i = 0; i < 100; i++) {
    if(random(0,100)>90) continue
    createParalaxItem(random(0,100)+random(-spawnBorder,spawnBorder))
}

window.addEventListener('resize', ()=>{spawnBorder = window.innerHeight})

requestAnimationFrame(init)
function init() {

    requestAnimationFrame(init)
    if(frame < 30) {
        lastScroll = window.scrollY
        frame++
        return
    }

    const diffAbs = Math.abs(window.scrollY - lastScroll)
    const diff = window.scrollY - lastScroll

    // video.style.filter = 'hue-rotate('+(130+window.scrollY/100)+'deg) blur(5px)'
    const paralax_items = document.querySelectorAll('.paralax-item')
    paralax_items.forEach((item)=>{
        if(finish.getBoundingClientRect().top < 100){
        }
        item.velocity += diff*item.speed*0.5
        if(finish.getBoundingClientRect().top < 100 || someQuote()){
            item.style.width = '20px'
            item.velocity += 20
        }
        else {
            item.style.width = '5px'
        }
        item.velocity = minmax(-100,item.velocity,100)
        item.pos -= item.velocity*0.05
        item.style.top = item.pos + '%'
        // item.style.opacity = Math.abs(item.velocity)/10
        // item.style.opacity = 1
        item.style.height = minmax(5, Math.abs(item.velocity)*5, 1000) + 'px'
        // item.style.filter = 'hue-rotate('+diffAbs/10+'deg)'
        if(item.pos > 100+spawnBorder) {
            item.remove()
            createParalaxItem(random(-spawnBorder,0), item.velocity*0.8)
        }
        if(item.pos < -spawnBorder) {
            item.remove()
            createParalaxItem(100+random(0,spawnBorder), item.velocity*0.8)
        }
        item.velocity/=1.2
    })

    items.forEach((item)=>{
        const element = item.element
        if(element && !item.quote){
            // element.style.transform = 'scaleY('+(1+Math.min(diffAbs/300,.3))+') scale('+(1-(element.getBoundingClientRect().top+100)/6000)+')'
            // element.style.transform = 'scale('+(1-Math.min(diffAbs/300,.3))+')'
            const size = element.getBoundingClientRect().bottom/window.innerHeight
            const nsize = -minmax(0,size/2,1)+.5
            element.style.transform = 'scale('+(1+nsize)+')'
        }
    })

    lastScroll = window.scrollY
}

function someQuote() {
    const center = window.innerHeight / 2
    const margin = window.innerHeight / 4

    return quotes.some(q => {
        const rect = q.getBoundingClientRect()
        return rect.top <= center + margin && rect.bottom >= center - margin
    })
}



</script>